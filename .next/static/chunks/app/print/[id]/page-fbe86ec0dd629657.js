(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[772],{4941:function(e,a,n){Promise.resolve().then(n.bind(n,9700))},9700:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return PrintDetailPage}});var t=n(7437),s=n(2265),i=n(4033),l=n(6691),r=n.n(l),c=n(1993),o=n(243),d=n(3236),h=n(1037);let ArrowBackIcon=()=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,t.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})]}),DownloadIcon=()=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,t.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})]}),CategoryIcon=()=>(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"currentColor",children:[(0,t.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,t.jsx)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5-10-5-10 5zM12 14l-8 4 8 4 8-4-8-4z"})]});function PrintDetailPage(e){let{params:a}=e,n=(0,i.useRouter)(),{id:l}=a,[x,g]=(0,s.useState)(null),[m,u]=(0,s.useState)(!0),[j,p]=(0,s.useState)(null),[f,v]=(0,s.useState)(!1),[w,N]=(0,s.useState)([]),{refreshPrints:y}=(0,h.Q)(null);(0,s.useEffect)(()=>{async function fetchCategories(){try{let e=await (0,c.tG)();N(e)}catch(e){console.error("Failed to fetch categories:",e)}}(async function(){try{let e=await (0,c.d0)(l);e?g(e):p("Print not found.")}catch(e){p(e.message)}finally{u(!1)}})(),fetchCategories()},[l]);let handleCategoryChange=async e=>{if(x)try{await (0,c.LR)(x.id,e),g(a=>a?{...a,category_name:e}:null),y(),v(!1)}catch(e){alert("Failed to update category: ".concat(e.message))}};return m?(0,t.jsx)("div",{className:"page-container",children:(0,t.jsxs)("div",{className:"loading-container",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("p",{className:"loading-text",children:"読み込み中..."})]})}):j?(0,t.jsx)("div",{className:"page-container",children:(0,t.jsxs)("div",{className:"error-message-container",children:[(0,t.jsxs)("p",{className:"error-message",children:["エラー: ",j]}),(0,t.jsx)("button",{onClick:()=>n.back(),className:"button-primary",children:"戻る"})]})}):x?(0,t.jsxs)("div",{className:"page-container print-detail-page",children:[(0,t.jsxs)("header",{className:"detail-header",children:[(0,t.jsx)("button",{onClick:()=>n.back(),className:"icon-button",children:(0,t.jsx)(ArrowBackIcon,{})}),(0,t.jsx)("h1",{className:"detail-title",children:x.filename}),(0,t.jsx)("button",{onClick:()=>{(null==x?void 0:x.url)&&window.open(x.url,"_blank")},className:"icon-button",children:(0,t.jsx)(DownloadIcon,{})})]}),(0,t.jsxs)("main",{className:"detail-content",children:[(0,t.jsx)("div",{className:"detail-image-container",children:(0,t.jsx)(r(),{src:x.url,alt:x.filename,layout:"fill",objectFit:"contain",className:"detail-image"})}),(0,t.jsxs)("div",{className:"detail-info",children:[(0,t.jsxs)("p",{className:"detail-info-item",children:[(0,t.jsx)("strong",{children:"アップロード日:"})," ",new Date(x.uploaded_at).toLocaleDateString()]}),x.family_member&&(0,t.jsxs)("p",{className:"detail-info-item",children:[(0,t.jsx)("strong",{children:"家族メンバー:"})," ",x.family_member]}),(0,t.jsxs)("div",{className:"detail-info-item category-section",children:[(0,t.jsx)("strong",{children:"カテゴリ:"})," ",x.category_name||"未分類",(0,t.jsxs)("button",{onClick:()=>v(!0),className:"button-secondary category-edit-button",children:[(0,t.jsx)(CategoryIcon,{})," カテゴリ変更"]})]})]})]}),(0,t.jsx)(o.Z,{isOpen:f,onClose:()=>v(!1),title:"カテゴリ変更",children:(0,t.jsx)(d.Z,{onClose:()=>v(!1),existingCategories:w,onCategoryUpdated:handleCategoryChange,isForSinglePrint:!0,currentPrintCategory:x.category_name})})]}):(0,t.jsx)("div",{className:"page-container",children:(0,t.jsxs)("div",{className:"error-message-container",children:[(0,t.jsx)("p",{className:"error-message",children:"プリントが見つかりませんでした。"}),(0,t.jsx)("button",{onClick:()=>n.back(),className:"button-primary",children:"戻る"})]})})}}},function(e){e.O(0,[183,691,316,971,472,744],function(){return e(e.s=4941)}),_N_E=e.O()}]);