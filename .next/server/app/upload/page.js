(()=>{var e={};e.id=676,e.ids=[676],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},3978:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>d,pages:()=>p,routeModule:()=>x,tree:()=>o});var r=t(7096),a=t(6132),i=t(7284),n=t.n(i),l=t(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["upload",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5196)),"/Users/satokeita/Dev/famiPrint/famiPrint/app/upload/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3389)),"/Users/satokeita/Dev/famiPrint/famiPrint/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],p=["/Users/satokeita/Dev/famiPrint/famiPrint/app/upload/page.tsx"],d="/upload/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/upload/page",pathname:"/upload",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},471:(e,s,t)=>{Promise.resolve().then(t.bind(t,8342))},8342:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>UploadPage});var r=t(784),a=t(9885),i=t(7114),n=t(1440),l=t.n(n),c=t(6310),o=t(4431);let ArrowBackIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000",children:[r.jsx("path",{d:"M0 0h24v24H0V0z",fill:"none"}),r.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})]}),UploadFileIcon=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48px",viewBox:"0 0 24 24",width:"48px",fill:"#6750A4",children:[r.jsx("path",{d:"M0 0h24v24H0V0z",fill:"none"}),r.jsx("path",{d:"M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"})]});function UploadPage(){let e=(0,i.useRouter)(),{categories:s}=(0,o.Q)(null),[t,n]=(0,a.useState)(!1),[p,d]=(0,a.useState)([]),[u,x]=(0,a.useState)(!1),h=(0,a.useRef)(null),[m,g]=(0,a.useState)(null),[v,f]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),handleFileChange=e=>{e&&d(Array.from(e))},handleUpload=async()=>{if(0===p.length){alert("ファイルを選択してください。");return}if(!m){alert("家族のメンバーを選択してください。");return}let s=j.trim()||v;if(!s){alert("カテゴリを選択または入力してください。");return}n(!0);try{await (0,c.L2)(p,m,s),alert("アップロードが完了しました。"),e.push("/")}catch(e){console.error("Upload failed:",e),alert("アップロードに失敗しました。")}finally{n(!1)}};return(0,r.jsxs)("div",{className:"page-background",children:[r.jsx("header",{className:"top-app-bar",children:(0,r.jsxs)("div",{className:"app-bar-content",children:[r.jsx(l(),{href:"/",className:"icon-button",children:r.jsx(ArrowBackIcon,{})}),r.jsx("h1",{className:"app-bar-title",children:"新しいプリントを追加"})]})}),r.jsx("main",{className:"main-content-area",children:(0,r.jsxs)("div",{className:"card-container",children:[(0,r.jsxs)("section",{className:"section-spacing",children:[r.jsx("h2",{className:"section-title",children:"1. だれのもの？"}),r.jsx("div",{className:"flex-chips-container",children:["かえで","しおり","あん","ママ","パパ"].map(e=>r.jsx("button",{onClick:()=>g(e),className:`chip-base ${m===e?"chip-selected":"chip-unselected"}`,children:e},e))})]}),(0,r.jsxs)("section",{className:"section-spacing",children:[r.jsx("h2",{className:"section-title",children:"2. どんな種類？"}),(0,r.jsxs)("div",{className:"grid-form-elements",children:[(0,r.jsxs)("select",{value:v,onChange:e=>{f(e.target.value),e.target.value&&N("")},disabled:t||!!j,className:"form-input",children:[r.jsx("option",{value:"",children:"既存のカテゴリ..."}),s.map(e=>r.jsx("option",{value:e.name,children:e.name},e.id))]}),r.jsx("input",{type:"text",placeholder:"または新しいカテゴリ...",value:j,onChange:e=>{N(e.target.value),e.target.value&&f("")},disabled:t,className:"form-input"})]})]}),(0,r.jsxs)("section",{className:"section-spacing-large",children:[r.jsx("h2",{className:"section-title",children:"3. ファイルを選ぶ"}),(0,r.jsxs)("div",{onClick:()=>h.current?.click(),onDragOver:e=>{e.preventDefault(),x(!0)},onDragLeave:e=>x(!1),onDrop:e=>{e.preventDefault(),x(!1),handleFileChange(e.dataTransfer.files)},className:`drag-drop-area ${u?"drag-over":""}`,children:[r.jsx("input",{ref:h,type:"file",multiple:!0,accept:"image/*,application/pdf",className:"hidden-input",onChange:e=>handleFileChange(e.target.files)}),(0,r.jsxs)("div",{className:"drag-drop-text-container",children:[r.jsx(UploadFileIcon,{}),r.jsx("p",{className:"margin-top-small",children:"ファイルをドラッグ＆ドロップ"}),r.jsx("p",{className:"text-small",children:"またはクリックして選択"})]})]}),p.length>0&&(0,r.jsxs)("div",{className:"file-list-container",children:[(0,r.jsxs)("p",{children:[p.length,"個のファイルを選択中:"]}),r.jsx("ul",{className:"file-list",children:p.map(e=>r.jsx("li",{children:e.name},e.name))})]})]}),r.jsx("div",{className:"text-align-center",children:r.jsx("button",{onClick:handleUpload,disabled:t||0===p.length||!m||!v&&!j,className:"primary-button",children:t?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"spinner"}),r.jsx("span",{children:"アップロード中..."})]}):r.jsx("span",{children:"アップロードする"})})})]})})]})}},5196:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>i,default:()=>c});var r=t(5153);let a=(0,r.createProxy)(String.raw`/Users/satokeita/Dev/famiPrint/famiPrint/app/upload/page.tsx`),{__esModule:i,$$typeof:n}=a,l=a.default,c=l}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[611,485,440,606,50,431],()=>__webpack_exec__(3978));module.exports=t})();