"use strict";exports.id=667,exports.ids=[667],exports.modules={4667:(e,t,o)=>{o.d(t,{Z:()=>CategoryEditor});var a=o(784),s=o(9885),r=o(9708),l=o(6634),c=o(6110);function ConfirmModal({isOpen:e,onClose:t,message:o,onConfirm:s,onCancel:r}){return(0,a.jsxs)(c.Z,{isOpen:e,onClose:t,title:"確認",children:[a.jsx("p",{children:o}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[a.jsx("button",{onClick:()=>{r(),t()},className:"category-editor-close-button",children:"キャンセル"}),a.jsx("button",{onClick:()=>{s(),t()},className:"primary-button",children:"OK"})]})]})}let EditIcon=()=>a.jsx("svg",{className:"icon",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),DeleteIcon=()=>a.jsx("svg",{className:"icon",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})}),SaveIcon=()=>a.jsx("svg",{className:"icon",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"})}),CancelIcon=()=>a.jsx("svg",{className:"icon",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"})});function CategoryEditor({onClose:e,existingCategories:t,onCategoryUpdated:o,isForSinglePrint:c=!1,currentPrintCategory:n}){let{showNotification:i}=(0,l.useNotification)(),[d,m]=(0,s.useState)(""),[u,h]=(0,s.useState)(null),[g,x]=(0,s.useState)(""),[y,j]=(0,s.useState)(!1),[v,p]=(0,s.useState)(null),[C,N]=(0,s.useState)(n||null),performDeleteCategory=async e=>{try{let{error:t}=await r.O.from("categories").delete().eq("id",e.id);if(t)throw t;i(`カテゴリ「${e.name}」を削除しました。`,"success")}catch(e){i(`カテゴリの削除に失敗しました: ${e.message}`,"error")}},handleAddCategory=async()=>{if(""===d.trim()){i("カテゴリ名を入力してください。","error");return}try{let{data:e,error:t}=await r.O.from("categories").insert([{name:d.trim()}]).select();if(t)throw t;i(`カテゴリ「${d}」を追加しました。`,"success"),m("")}catch(e){console.error("Failed to add category:",e),i(`カテゴリの追加に失敗しました: ${e.message}`,"error")}},handleEditCategory=async e=>{let t=g.trim();if(""===t){i("カテゴリ名を入力してください。","error");return}try{let{error:o}=await r.O.from("categories").update({name:t}).eq("id",e.id);if(o)throw o;i(`カテゴリを更新しました。`,"success"),h(null)}catch(e){i(`カテゴリの更新に失敗しました: ${e.message}`,"error")}},handleDeleteCategory=e=>{p(e),j(!0)};return(0,a.jsxs)("div",{className:"category-editor-content",onClick:e=>e.stopPropagation(),children:[a.jsx("h2",{className:"category-editor-title",children:c?"カテゴリ変更":"カテゴリ管理"}),c?(0,a.jsxs)("div",{className:"category-editor-section",children:[a.jsx("h3",{className:"category-editor-subtitle",children:"カテゴリを選択"}),(0,a.jsxs)("select",{value:C||"",onChange:e=>N(e.target.value||null),className:"category-editor-select",children:[a.jsx("option",{value:"",children:"未分類"}),t.map(e=>a.jsx("option",{value:e.name,children:e.name},e.id))]}),(0,a.jsxs)("div",{className:"category-editor-footer",children:[a.jsx("button",{onClick:()=>{o(C),e()},className:"category-editor-save-button",children:"保存"}),a.jsx("button",{onClick:e,className:"category-editor-close-button",children:"キャンセル"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"category-editor-section",children:[a.jsx("h3",{className:"category-editor-subtitle",children:"新しいカテゴリを追加"}),(0,a.jsxs)("div",{className:"category-editor-input-group",children:[a.jsx("input",{type:"text",placeholder:"新しいカテゴリ名",value:d,onChange:e=>m(e.target.value),className:"category-editor-input"}),a.jsx("button",{onClick:handleAddCategory,className:"category-editor-add-button",children:"追加"})]})]}),(0,a.jsxs)("div",{className:"category-editor-section",children:[a.jsx("h3",{className:"category-editor-subtitle",children:"既存カテゴリ"}),t&&0===t.length?a.jsx("p",{className:"category-editor-no-category-message",children:"まだカテゴリがありません。"}):a.jsx("ul",{className:"category-editor-category-list",children:t&&t.map(e=>(0,a.jsxs)("li",{className:"category-editor-category-item",children:[u?.id===e.id?a.jsx("input",{type:"text",value:g,onChange:e=>x(e.target.value),className:"category-editor-edit-input",autoFocus:!0}):a.jsx("span",{className:"category-editor-category-name",children:e.name}),a.jsx("div",{className:"category-editor-actions",children:u?.id===e.id?(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>handleEditCategory(e),className:"category-editor-action-button primary",children:a.jsx(SaveIcon,{})}),a.jsx("button",{onClick:()=>h(null),className:"category-editor-action-button",children:a.jsx(CancelIcon,{})})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>{h(e),x(e.name)},className:"category-editor-action-button",children:a.jsx(EditIcon,{})}),a.jsx("button",{onClick:()=>handleDeleteCategory(e),className:"category-editor-action-button error",children:a.jsx(DeleteIcon,{})})]})})]},e.id))})]}),a.jsx("div",{className:"category-editor-footer",children:a.jsx("button",{onClick:e,className:"category-editor-close-button",children:"閉じる"})})]}),v&&a.jsx(ConfirmModal,{isOpen:y,onClose:()=>j(!1),message:`カテゴリ「${v.name}」を削除しますか？関連するプリントのカテゴリは解除されます。`,onConfirm:()=>{performDeleteCategory(v),p(null)},onCancel:()=>p(null)})]})}},6110:(e,t,o)=>{o.d(t,{Z:()=>Modal});var a=o(784),s=o(9885);function Modal({isOpen:e,onClose:t,children:o,title:r}){let l=(0,s.useRef)(null);return((0,s.useEffect)(()=>{let handleEscape=e=>{"Escape"===e.key&&t()};return e?(document.addEventListener("keydown",handleEscape),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",handleEscape),document.body.style.overflow=""),()=>{document.removeEventListener("keydown",handleEscape),document.body.style.overflow=""}},[e,t]),e)?a.jsx("div",{className:"modal-overlay",onClick:t,children:(0,a.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),ref:l,children:[(0,a.jsxs)("div",{className:"modal-header",children:[r&&a.jsx("h2",{className:"modal-title",children:r}),a.jsx("button",{className:"modal-close-button",onClick:t,children:"\xd7"})]}),a.jsx("div",{className:"modal-body",children:o})]})}):null}}};